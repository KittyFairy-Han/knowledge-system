<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="image/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/knowledge-system/assets/css/0.styles.4e160e22.css" as="style"><link rel="preload" href="/knowledge-system/assets/js/app.4492b903.js" as="script"><link rel="preload" href="/knowledge-system/assets/js/2.3522bde2.js" as="script"><link rel="preload" href="/knowledge-system/assets/js/62.a479d1c1.js" as="script"><link rel="prefetch" href="/knowledge-system/assets/js/10.22a28efc.js"><link rel="prefetch" href="/knowledge-system/assets/js/11.145e65db.js"><link rel="prefetch" href="/knowledge-system/assets/js/12.30b41d72.js"><link rel="prefetch" href="/knowledge-system/assets/js/13.d55a9809.js"><link rel="prefetch" href="/knowledge-system/assets/js/14.6be7a54b.js"><link rel="prefetch" href="/knowledge-system/assets/js/15.8d1a16c8.js"><link rel="prefetch" href="/knowledge-system/assets/js/16.f109485c.js"><link rel="prefetch" href="/knowledge-system/assets/js/17.1964e4c6.js"><link rel="prefetch" href="/knowledge-system/assets/js/18.82b004fa.js"><link rel="prefetch" href="/knowledge-system/assets/js/19.810391c6.js"><link rel="prefetch" href="/knowledge-system/assets/js/20.2021f523.js"><link rel="prefetch" href="/knowledge-system/assets/js/21.283716dd.js"><link rel="prefetch" href="/knowledge-system/assets/js/22.899b6705.js"><link rel="prefetch" href="/knowledge-system/assets/js/23.d29a688d.js"><link rel="prefetch" href="/knowledge-system/assets/js/24.7c93b536.js"><link rel="prefetch" href="/knowledge-system/assets/js/25.37797cb8.js"><link rel="prefetch" href="/knowledge-system/assets/js/26.bf3954e6.js"><link rel="prefetch" href="/knowledge-system/assets/js/27.1d613afa.js"><link rel="prefetch" href="/knowledge-system/assets/js/28.21b7fecf.js"><link rel="prefetch" href="/knowledge-system/assets/js/29.0c2a1d17.js"><link rel="prefetch" href="/knowledge-system/assets/js/3.43094df6.js"><link rel="prefetch" href="/knowledge-system/assets/js/30.4b0b516b.js"><link rel="prefetch" href="/knowledge-system/assets/js/31.0053832a.js"><link rel="prefetch" href="/knowledge-system/assets/js/32.30eb3ceb.js"><link rel="prefetch" href="/knowledge-system/assets/js/33.aeada6d4.js"><link rel="prefetch" href="/knowledge-system/assets/js/34.7d831276.js"><link rel="prefetch" href="/knowledge-system/assets/js/35.bf96751b.js"><link rel="prefetch" href="/knowledge-system/assets/js/36.95b248b5.js"><link rel="prefetch" href="/knowledge-system/assets/js/37.45bc5e2e.js"><link rel="prefetch" href="/knowledge-system/assets/js/38.2a035baf.js"><link rel="prefetch" href="/knowledge-system/assets/js/39.eceb5aae.js"><link rel="prefetch" href="/knowledge-system/assets/js/4.058f70f4.js"><link rel="prefetch" href="/knowledge-system/assets/js/40.c4942197.js"><link rel="prefetch" href="/knowledge-system/assets/js/41.bad01060.js"><link rel="prefetch" href="/knowledge-system/assets/js/42.21d2f0bf.js"><link rel="prefetch" href="/knowledge-system/assets/js/43.fcc65805.js"><link rel="prefetch" href="/knowledge-system/assets/js/44.ffede619.js"><link rel="prefetch" href="/knowledge-system/assets/js/45.26b61498.js"><link rel="prefetch" href="/knowledge-system/assets/js/46.b474d3b8.js"><link rel="prefetch" href="/knowledge-system/assets/js/47.ff4fa17b.js"><link rel="prefetch" href="/knowledge-system/assets/js/48.92b30c52.js"><link rel="prefetch" href="/knowledge-system/assets/js/49.d5e95780.js"><link rel="prefetch" href="/knowledge-system/assets/js/5.7840448f.js"><link rel="prefetch" href="/knowledge-system/assets/js/50.db9933b1.js"><link rel="prefetch" href="/knowledge-system/assets/js/51.e8c83af0.js"><link rel="prefetch" href="/knowledge-system/assets/js/52.19667db8.js"><link rel="prefetch" href="/knowledge-system/assets/js/53.f2c3150e.js"><link rel="prefetch" href="/knowledge-system/assets/js/54.56cf6ce5.js"><link rel="prefetch" href="/knowledge-system/assets/js/55.74a46a4d.js"><link rel="prefetch" href="/knowledge-system/assets/js/56.07d66987.js"><link rel="prefetch" href="/knowledge-system/assets/js/57.6e73c719.js"><link rel="prefetch" href="/knowledge-system/assets/js/58.0abae5ac.js"><link rel="prefetch" href="/knowledge-system/assets/js/59.58f6eb45.js"><link rel="prefetch" href="/knowledge-system/assets/js/6.46d07af0.js"><link rel="prefetch" href="/knowledge-system/assets/js/60.43da1e15.js"><link rel="prefetch" href="/knowledge-system/assets/js/61.4ce82da9.js"><link rel="prefetch" href="/knowledge-system/assets/js/63.d0add6b4.js"><link rel="prefetch" href="/knowledge-system/assets/js/64.4594391c.js"><link rel="prefetch" href="/knowledge-system/assets/js/65.d27951d8.js"><link rel="prefetch" href="/knowledge-system/assets/js/66.948f50bb.js"><link rel="prefetch" href="/knowledge-system/assets/js/67.ce6538d6.js"><link rel="prefetch" href="/knowledge-system/assets/js/68.a4a194f4.js"><link rel="prefetch" href="/knowledge-system/assets/js/69.c6b1375d.js"><link rel="prefetch" href="/knowledge-system/assets/js/7.2777c9d4.js"><link rel="prefetch" href="/knowledge-system/assets/js/70.27f3eda7.js"><link rel="prefetch" href="/knowledge-system/assets/js/71.9c695185.js"><link rel="prefetch" href="/knowledge-system/assets/js/72.ee21a120.js"><link rel="prefetch" href="/knowledge-system/assets/js/73.10a48580.js"><link rel="prefetch" href="/knowledge-system/assets/js/74.20760841.js"><link rel="prefetch" href="/knowledge-system/assets/js/75.5c4ff11a.js"><link rel="prefetch" href="/knowledge-system/assets/js/76.175f4b4b.js"><link rel="prefetch" href="/knowledge-system/assets/js/77.f5faacec.js"><link rel="prefetch" href="/knowledge-system/assets/js/78.7bdf2bb0.js"><link rel="prefetch" href="/knowledge-system/assets/js/79.d48961ea.js"><link rel="prefetch" href="/knowledge-system/assets/js/8.f3d1da5a.js"><link rel="prefetch" href="/knowledge-system/assets/js/80.1dc29e35.js"><link rel="prefetch" href="/knowledge-system/assets/js/81.6e26603d.js"><link rel="prefetch" href="/knowledge-system/assets/js/82.d33c0e3e.js"><link rel="prefetch" href="/knowledge-system/assets/js/83.c1a041c3.js"><link rel="prefetch" href="/knowledge-system/assets/js/84.f09d0e23.js"><link rel="prefetch" href="/knowledge-system/assets/js/85.c823c3b3.js"><link rel="prefetch" href="/knowledge-system/assets/js/86.07e9f9c7.js"><link rel="prefetch" href="/knowledge-system/assets/js/87.24e8649c.js"><link rel="prefetch" href="/knowledge-system/assets/js/88.fef9674a.js"><link rel="prefetch" href="/knowledge-system/assets/js/9.2bd407cb.js">
    <link rel="stylesheet" href="/knowledge-system/assets/css/0.styles.4e160e22.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/knowledge-system/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/knowledge-system/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/knowledge-system/CSS/layout/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/knowledge-system/JS/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/knowledge-system/React/" class="nav-link router-link-active">
  React
</a></div><div class="nav-item"><a href="/knowledge-system/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/knowledge-system/broswer/work/" class="nav-link">
  æµè§ˆå™¨
</a></div><div class="nav-item"><a href="/knowledge-system/engineering/" class="nav-link">
  å·¥ç¨‹åŒ–
</a></div><div class="nav-item"><a href="/knowledge-system/scene/lottieUsage/" class="nav-link">
  å…¶ä»–
</a></div><div class="nav-item"><a href="/knowledge-system/web3d/" class="nav-link">
  web3d
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/knowledge-system/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/knowledge-system/CSS/layout/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/knowledge-system/JS/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/knowledge-system/React/" class="nav-link router-link-active">
  React
</a></div><div class="nav-item"><a href="/knowledge-system/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/knowledge-system/broswer/work/" class="nav-link">
  æµè§ˆå™¨
</a></div><div class="nav-item"><a href="/knowledge-system/engineering/" class="nav-link">
  å·¥ç¨‹åŒ–
</a></div><div class="nav-item"><a href="/knowledge-system/scene/lottieUsage/" class="nav-link">
  å…¶ä»–
</a></div><div class="nav-item"><a href="/knowledge-system/web3d/" class="nav-link">
  web3d
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ä¸ƒä¸ƒå…«å…«</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/React/7788/set-interval.html" class="sidebar-link">functional component ä¸­çš„ setInterval</a></li><li><a href="/knowledge-system/React/7788/react-etc.html" class="sidebar-link">reactç›¸å…³æŠ€æœ¯æ ˆ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/knowledge-system/React/state-management/" class="sidebar-heading clickable router-link-active open"><span>çŠ¶æ€ç®¡ç†</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/React/state-management/context-vs-redux.html" class="sidebar-link">reduxåŸºç¡€</a></li><li><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html" aria-current="page" class="active sidebar-link">reduxçš„combineReducerå’Œä¸­é—´ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#react-redux-hooks-ä¸-connect" class="sidebar-link">react-redux hooks ä¸ connect</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#ä½¿ç”¨å¯¹æ¯”" class="sidebar-link">ä½¿ç”¨å¯¹æ¯”</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#æ¨¡æ‹Ÿ-useselector-ä¸-usedispatch" class="sidebar-link">æ¨¡æ‹Ÿ useSelector ä¸ useDispatch</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#connect-ä¸-hooks-å¯¹æ¯”" class="sidebar-link">connect ä¸ hooks å¯¹æ¯”</a></li></ul></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬" class="sidebar-link">ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#combinereducer" class="sidebar-link">combineReducer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#ç”¨æ³•" class="sidebar-link">ç”¨æ³•</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#åŸç†" class="sidebar-link">åŸç†</a></li></ul></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#ä¸­é—´ä»¶" class="sidebar-link">ä¸­é—´ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#ä¸­é—´ä»¶å…¬å¼" class="sidebar-link">ä¸­é—´ä»¶å…¬å¼</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#å°è¯•ç‰›åˆ€-redux-thunk" class="sidebar-link">å°è¯•ç‰›åˆ€ redux-thunk</a></li></ul></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#redux-saga-é—ªäº®ç™»åœº" class="sidebar-link">redux-saga é—ªäº®ç™»åœº</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#ä½¿ç”¨ç¤ºä¾‹" class="sidebar-link">ä½¿ç”¨ç¤ºä¾‹</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html#åŸç†-2" class="sidebar-link">åŸç†</a></li></ul></li></ul></li><li><a href="/knowledge-system/React/state-management/zustand.html" class="sidebar-link">zustand</a></li><li><a href="/knowledge-system/React/state-management/jotai.html" class="sidebar-link">jotai</a></li></ul></section></li><li><a href="/knowledge-system/React/animate/" class="sidebar-link">åŠ¨ç”»åº“</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>æ²¡æœ‰åºŸè¯ï¼æ¥ç€æ¥ redux hooks</p> <h2 id="react-redux-hooks-ä¸-connect"><a href="#react-redux-hooks-ä¸-connect" class="header-anchor">#</a> react-redux hooks ä¸ connect</h2> <p>ä¸Šé¢çš„ connect çœŸæ˜¯å¤Ÿç»•çš„å“ˆ ğŸ˜…ï¼Œæˆ‘åˆšæ¥è§¦çš„æ—¶å€™ä¹Ÿçœ‹å‚» ğŸ‘€ äº†ã€‚connect æ˜¯é«˜é˜¶å‡½æ•°å®ç°å¤ç”¨é€»è¾‘çš„æ€æƒ³ï¼Œä»¥å‰ react è¿˜æ²¡æœ‰ hook çš„æ—¶å€™å®ç°é€»è¾‘å¤ç”¨ä¹Ÿéƒ½æ˜¯ç”¨è¿™ç§æ–¹å¼è¿›è¡Œé€»è¾‘æ³¨å…¥ï¼Œreact å‡ºäº† hooksï¼Œreact-redux ä¹Ÿæä¾›äº† hooksï¼Œç”¨èµ·æ¥çœŸæ˜¯é¡ºæºœ ğŸ˜Š å¤šäº†ï¼</p> <h3 id="ä½¿ç”¨å¯¹æ¯”"><a href="#ä½¿ç”¨å¯¹æ¯”" class="header-anchor">#</a> ä½¿ç”¨å¯¹æ¯”</h3> <ul><li>ç”¨ react-redux çš„ connect :ä¸Šæ–‡å·²æè¿‡ï¼Œç•¥</li> <li>ç”¨ react-redux çš„ hooks : ByReactReduxHook</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;../styles.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useSelector<span class="token punctuation">,</span> useDispatch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reducer<span class="token punctuation">,</span> actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./store&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**æ˜¾ç¤ºç»„ä»¶ */</span>
<span class="token keyword">const</span> <span class="token function-variable function">ShowCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> stateCount <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>count<span class="token operator">:</span><span class="token punctuation">{</span>stateCount<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**æ“ä½œç»„ä»¶ */</span>
<span class="token keyword">const</span> <span class="token function-variable function">ChangeCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">dispatchIncreatment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span>actions<span class="token punctuation">.</span><span class="token constant">INCREASE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">dispatchDecreatment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span>actions<span class="token punctuation">.</span><span class="token constant">DECREASE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatchDecreatment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>â–<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatchIncreatment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>â•<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**======================================== */</span>
<span class="token keyword">const</span> <span class="token function-variable function">ByReactReduxHook</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;App&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>ç”¨ react<span class="token operator">-</span>redux hooks åšæ•°æ®ç®¡ç†<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* é‡è¦ï¼ */</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ShowCount <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ChangeCount <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ByReactReduxHook<span class="token punctuation">;</span>
</code></pre></div><p><em>Provider è¿˜æ˜¯é‚£ä¸ª Providerï¼ŒæŠŠ connect è¿™ç§ HOC çš„æ–¹å¼æ¢æˆ useSelector+useDispatch è¿™ç§ Hook çš„æ–¹å¼äº†</em></p> <h3 id="æ¨¡æ‹Ÿ-useselector-ä¸-usedispatch"><a href="#æ¨¡æ‹Ÿ-useselector-ä¸-usedispatch" class="header-anchor">#</a> æ¨¡æ‹Ÿ useSelector ä¸ useDispatch</h3> <p>ï¼ˆå…¶å®è¿˜æœ‰ useStore è¿™ä¸ª hookï¼Œä½†ä¸æ€ä¹ˆç”¨ï¼Œä¸ä»‹ç»äº†ï¼‰</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åœ¨ä¸Šæ–‡ä¸­ ç®€æ˜“æ¨¡æ‹Ÿ react-redux çš„ Provider å’Œ connect ä»£ç åé¢è¿½åŠ </span>
<span class="token keyword">const</span> <span class="token function-variable function">useSelector</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>storeContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> selectState <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> selectState <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// how to trigger component renderï¼Ÿ</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> selectState<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">useDispatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>storeContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> store<span class="token punctuation">.</span>dispatch<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> useSelector<span class="token punctuation">,</span> useDispatch <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="connect-ä¸-hooks-å¯¹æ¯”"><a href="#connect-ä¸-hooks-å¯¹æ¯”" class="header-anchor">#</a> connect ä¸ hooks å¯¹æ¯”</h3> <p>hooks ä¼˜ç‚¹</p> <ul><li>æ›´å®¹æ˜“ç†è§£ã€æ˜“ä¸Šæ‰‹ã€</li> <li>æ›´ç¬¦åˆ React Functional Component çš„æ€æƒ³ï¼Œå®˜æ–¹ä¹Ÿæ˜¯æ¨èä½¿ç”¨ hooks çš„æ–¹å¼ã€‚</li> <li>ä¾‹å­ä¸­åšäº†ä¸ªå°å®éªŒï¼Œæ¸²æŸ“æ€§èƒ½ä¸Šä¹Ÿæ˜¯ useSelector æ›´å¥½
æ¬¢è¿è¯„è®ºåŒºè¯´å‡º connect æ¯” hooks å¥½çš„ç‚¹ ğŸ˜‚</li></ul> <h2 id="ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬"><a href="#ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬" class="header-anchor">#</a> ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬ğŸŒ¸ğŸŒŸğŸ¬</h2> <p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç¢ç¢å¿µï¼š<br>
æœ¬æ¥åˆè¡·æ˜¯æƒ³æ‹©ä¼˜æˆ–è€…æŒ‰ä¸šåŠ¡åœºæ™¯æ¨èå¯¹åº”çš„ React çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼Œä½†æ˜¯å‘ç°äº†è¿™ä¸ªæœ‰æ¥æ— å›çš„ reduxï¼Œéƒ½å¿«å¿˜äº†åˆè¡·äº†ã€‚<br>
ä½† redux å…¨å®¶æ¡¶å¤ªä¸°ï¼ˆtaoï¼‰å¯Œï¼ˆyanï¼‰äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¿˜æ˜¯ç»§ç»­ combineReducerã€ä¸­é—´ä»¶ã€‚
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
â• æç¤ºï¼š<br> <a href="https://codesandbox.io/s/reactxue-xi-wz2rhs?file=/src/redux-extra/store/index.js" target="_blank" rel="noopener noreferrer">combineReducer,thunk ç›¸å…³ä»£ç <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
ä¸‹æ–‡åˆ—ä¸¾å…³é”®ä»£ç ï¼Œå®Œæ•´çœ‹ â¬…
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p> <h2 id="combinereducer"><a href="#combinereducer" class="header-anchor">#</a> combineReducer</h2> <h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="header-anchor">#</a> ç”¨æ³•</h3> <h4 id="_1-å®šä¹‰ä¸åŒçš„-reducer"><a href="#_1-å®šä¹‰ä¸åŒçš„-reducer" class="header-anchor">#</a> 1.å®šä¹‰ä¸åŒçš„ reducer</h4> <ul><li>countStore.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> countActionTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">INCREASE</span><span class="token operator">:</span> <span class="token string">&quot;INCREASE&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">DECREASE</span><span class="token operator">:</span> <span class="token string">&quot;DECREASE&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">countReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> countActionTypes<span class="token punctuation">.</span><span class="token constant">INCREASE</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> countActionTypes<span class="token punctuation">.</span><span class="token constant">DECREASE</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>todoStore.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">todoList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> todoActionTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">CREATE</span><span class="token operator">:</span> <span class="token string">&quot;CREATE&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">FINISH</span><span class="token operator">:</span> <span class="token string">&quot;FINISH&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">todoReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> todoActionTypes<span class="token punctuation">.</span><span class="token constant">CREATE</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">todoList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>todoList<span class="token punctuation">,</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> todoActionTypes<span class="token punctuation">.</span><span class="token constant">FINISH</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">todoList</span><span class="token operator">:</span> state<span class="token punctuation">.</span>todoList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id <span class="token operator">!==</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-combinereducer-å‡½æ•°"><a href="#_2-combinereducer-å‡½æ•°" class="header-anchor">#</a> 2.combineReducer å‡½æ•°</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> rootReducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">countStates</span><span class="token operator">:</span> countReducer<span class="token punctuation">,</span>
  <span class="token literal-property property">todoStates</span><span class="token operator">:</span> todoReducer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_3-ä¸šåŠ¡ä¸­ä½¿ç”¨æ³¨æ„-mapstatetoprops-æ¥å—çš„å‚æ•°"><a href="#_3-ä¸šåŠ¡ä¸­ä½¿ç”¨æ³¨æ„-mapstatetoprops-æ¥å—çš„å‚æ•°" class="header-anchor">#</a> 3.ä¸šåŠ¡ä¸­ä½¿ç”¨æ³¨æ„ mapStateToProps æ¥å—çš„å‚æ•°</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// stateæ˜¯rootStateè€Œä¸æ˜¯æŸä¸€ä¸ªå‘½åç©ºé—´ä¸‹çš„state</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>countStates<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="åŸç†"><a href="#åŸç†" class="header-anchor">#</a> åŸç†</h3> <p>reducer ä¸­çš„ state æ˜¯å‘½åç©ºé—´ä¸‹çš„ï¼Œè€Œ mapStateToProps æ¥æ”¶çš„ state æ˜¯ rootStateï¼Œå› ä¸º combineReducers å¤§æ¦‚å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * æ¨¡æ‹Ÿ combineReducer
 * @param {object} object
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token parameter">object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> keyList <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">rootReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">oldRootState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newRootState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log(&quot;oldRootState&quot;, oldRootState);</span>
    keyList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// dispatchä¸€ä¸ªactionçš„æ—¶å€™ï¼Œä¾æ¬¡è¿›å…¥æ¯ä¸ªreducerï¼Œè€Œä¸æ˜¯è¿›å…¥å‘½åç©ºé—´ä¸‹çš„æŸä¸€ä¸ªreducer</span>
      <span class="token keyword">const</span> reducer <span class="token operator">=</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// reducerä¸­çš„stateæ˜¯å‘½åç©ºé—´ä¸‹çš„state</span>
      <span class="token comment">// å› ä¸ºä¾æ¬¡è¿›å…¥æ¯ä¸ªactionï¼Œæ‰€ä»¥actionçš„typeç›¸åŒçš„æ—¶å€™ï¼Œä¼šå‘½ä¸­å¤šä¸ªreducerï¼Œéœ€è¦äººä¸ºæ§åˆ¶action.typeä¸åŒ</span>
      <span class="token comment">// connectä¼ å…¥mapStateToPropsçš„stateæ˜¯rootState</span>
      <span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token function">reducer</span><span class="token punctuation">(</span>oldRootState<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      newRootState<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newState<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log(&quot;newRootState&quot;, newRootState);</span>

    <span class="token keyword">return</span> newRootState<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> rootReducer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="header-anchor">#</a> ä¸­é—´ä»¶</h2> <h3 id="ä¸­é—´ä»¶å…¬å¼"><a href="#ä¸­é—´ä»¶å…¬å¼" class="header-anchor">#</a> ä¸­é—´ä»¶å…¬å¼</h3> <p>æ˜¯ä¸€ä¸ªä¸‰é˜¶å‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// next æ˜¯ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªä¸­é—´ä»¶ next = store.dispatch</span>
<span class="token keyword">const</span> <span class="token function-variable function">thunk</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">store</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¸­é—´ä»¶ä¸­çš„é€»è¾‘å¦‚ log ç­‰</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸šåŠ¡å±‚ dispatch ä¹‹ååœ¨ store å†…éƒ¨è¿™æ ·è°ƒç”¨ï¼Œæ‰€ä»¥å…¬å¼æ˜¯é‚£ä¸ªé¬¼ï¼ˆbushiï¼‰æ ·å­å’¯</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">someMiddleWare</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å°è¯•ç‰›åˆ€-redux-thunk"><a href="#å°è¯•ç‰›åˆ€-redux-thunk" class="header-anchor">#</a> å°è¯•ç‰›åˆ€ redux-thunk</h3> <p>redux-thunk ä½œä¸ºä¸€ä¸ªä¸­é—´ä»¶çš„å…¥é—¨æå¥½ï¼å†™ä¸€ä¸ªç±»ä¼¼ redux-thunk çš„ä¸­é—´ä»¶ï¼Œå®ç° dispatch åå¯ä»¥å¼‚æ­¥</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">thunk</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">store</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> action <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">action</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ç”¨ç”¨çœ‹å’¯</p> <ol><li>applyMiddleware</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å…³é”®ä»£ç å°±æ˜¯åœ¨ createStore æ—¶ applyMiddleware(thunk)</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>mapDispatchToProps æ·»åŠ ä¸€ä¸ªå¼‚æ­¥çš„ dispatch</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// æ–°å¢</span>
  <span class="token function-variable function">dispatchGetListAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span> getState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> todoActionTypes<span class="token punctuation">.</span><span class="token constant">INIT</span><span class="token punctuation">,</span> <span class="token literal-property property">payload</span><span class="token operator">:</span> list <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>List ç»„ä»¶è°ƒç”¨ dispatchGetListAsync</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">dispatchGetListAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code></pre></div><h2 id="redux-saga-é—ªäº®ç™»åœº"><a href="#redux-saga-é—ªäº®ç™»åœº" class="header-anchor">#</a> redux-saga é—ªäº®ç™»åœº</h2> <h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="header-anchor">#</a> ä½¿ç”¨ç¤ºä¾‹</h3> <p>å¯¹æ¯” thunk æ›´æ”¹ç‚¹ï¼š</p> <ol><li>é…ç½® saga</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ–°å¢ store/todoSaga.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> call<span class="token punctuation">,</span> put<span class="token punctuation">,</span> takeEvery<span class="token punctuation">,</span> all <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux-saga/effects&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> getTodoList <span class="token keyword">from</span> <span class="token string">&quot;../mocks/getTodoList&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> todoActionTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./todoStore&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">initTodoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> todoList <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>getTodoList<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ¨¡æ‹Ÿæ¥å£è¯·æ±‚</span>
  <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> todoActionTypes<span class="token punctuation">.</span><span class="token constant">INIT</span><span class="token punctuation">,</span> <span class="token literal-property property">payload</span><span class="token operator">:</span> todoList <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">todoSaga</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token function">takeEvery</span><span class="token punctuation">(</span><span class="token string">&quot;INIT_TODO_LIST&quot;</span><span class="token punctuation">,</span> initTodoList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>ä¸ thunk ä¸åŒçš„æ˜¯ï¼ŒcreateSagaMiddleware ä¸ sagaMiddleware.run(todoSaga)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ”¹é€  store/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> applyMiddleware<span class="token punctuation">,</span> createStore<span class="token punctuation">,</span> combineReducers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> createSagaMiddleware <span class="token keyword">from</span> <span class="token string">&quot;redux-saga&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> todoSaga <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./todoSaga&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> countActionTypes<span class="token punctuation">,</span> countReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./countStore&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> todoReducer<span class="token punctuation">,</span> todoActionTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./todoStore&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> rootReducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">countStates</span><span class="token operator">:</span> countReducer<span class="token punctuation">,</span>
  <span class="token literal-property property">todoStates</span><span class="token operator">:</span> todoReducer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sagaMiddleware <span class="token operator">=</span> <span class="token function">createSagaMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆ›å»ºä¸€ä¸ªå®ä¾‹</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>sagaMiddleware<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

sagaMiddleware<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>todoSaga<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//runæˆ‘ä»¬å†™çš„saga</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> countActionTypes<span class="token punctuation">,</span> todoActionTypes <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>dispatch saga ä¸­å®šä¹‰çš„ç±»å‹ï¼Œå¼‚æ­¥è¯·æ±‚é€»è¾‘å·²ç»æŒªåˆ° saga ä¸­ï¼Œdispatch æ›´æ¸…çˆ½</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ”¹é€  components/List.jsx</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">dispatchGetListAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// åªæœ‰ dispatchGetListAsync åšäº†æ›´æ”¹</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;INIT_TODO_LIST&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ....</span>
</code></pre></div><h3 id="åŸç†-2"><a href="#åŸç†-2" class="header-anchor">#</a> åŸç†</h3> <p>æºç å¤ªå¤ªå¤ªå¤æ‚äº†ï¼äº‰å–è¡¥ä¸ªæµç¨‹å›¾ï¼çœŸçš„èƒ½æ‘¸é€äº†å•ç‹¬å†™ä¸€ç¯‡å§ï¼</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/knowledge-system/React/state-management/context-vs-redux.html" class="prev">
        reduxåŸºç¡€
      </a></span> <span class="next"><a href="/knowledge-system/React/state-management/zustand.html">
        zustand
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/knowledge-system/assets/js/app.4492b903.js" defer></script><script src="/knowledge-system/assets/js/2.3522bde2.js" defer></script><script src="/knowledge-system/assets/js/62.a479d1c1.js" defer></script>
  </body>
</html>
