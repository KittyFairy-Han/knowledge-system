<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="image/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/knowledge-system/assets/css/0.styles.4e160e22.css" as="style"><link rel="preload" href="/knowledge-system/assets/js/app.4492b903.js" as="script"><link rel="preload" href="/knowledge-system/assets/js/2.3522bde2.js" as="script"><link rel="preload" href="/knowledge-system/assets/js/63.d0add6b4.js" as="script"><link rel="prefetch" href="/knowledge-system/assets/js/10.22a28efc.js"><link rel="prefetch" href="/knowledge-system/assets/js/11.145e65db.js"><link rel="prefetch" href="/knowledge-system/assets/js/12.30b41d72.js"><link rel="prefetch" href="/knowledge-system/assets/js/13.d55a9809.js"><link rel="prefetch" href="/knowledge-system/assets/js/14.6be7a54b.js"><link rel="prefetch" href="/knowledge-system/assets/js/15.8d1a16c8.js"><link rel="prefetch" href="/knowledge-system/assets/js/16.f109485c.js"><link rel="prefetch" href="/knowledge-system/assets/js/17.1964e4c6.js"><link rel="prefetch" href="/knowledge-system/assets/js/18.82b004fa.js"><link rel="prefetch" href="/knowledge-system/assets/js/19.810391c6.js"><link rel="prefetch" href="/knowledge-system/assets/js/20.2021f523.js"><link rel="prefetch" href="/knowledge-system/assets/js/21.283716dd.js"><link rel="prefetch" href="/knowledge-system/assets/js/22.899b6705.js"><link rel="prefetch" href="/knowledge-system/assets/js/23.d29a688d.js"><link rel="prefetch" href="/knowledge-system/assets/js/24.7c93b536.js"><link rel="prefetch" href="/knowledge-system/assets/js/25.37797cb8.js"><link rel="prefetch" href="/knowledge-system/assets/js/26.bf3954e6.js"><link rel="prefetch" href="/knowledge-system/assets/js/27.1d613afa.js"><link rel="prefetch" href="/knowledge-system/assets/js/28.21b7fecf.js"><link rel="prefetch" href="/knowledge-system/assets/js/29.0c2a1d17.js"><link rel="prefetch" href="/knowledge-system/assets/js/3.43094df6.js"><link rel="prefetch" href="/knowledge-system/assets/js/30.4b0b516b.js"><link rel="prefetch" href="/knowledge-system/assets/js/31.0053832a.js"><link rel="prefetch" href="/knowledge-system/assets/js/32.30eb3ceb.js"><link rel="prefetch" href="/knowledge-system/assets/js/33.aeada6d4.js"><link rel="prefetch" href="/knowledge-system/assets/js/34.7d831276.js"><link rel="prefetch" href="/knowledge-system/assets/js/35.bf96751b.js"><link rel="prefetch" href="/knowledge-system/assets/js/36.95b248b5.js"><link rel="prefetch" href="/knowledge-system/assets/js/37.45bc5e2e.js"><link rel="prefetch" href="/knowledge-system/assets/js/38.2a035baf.js"><link rel="prefetch" href="/knowledge-system/assets/js/39.eceb5aae.js"><link rel="prefetch" href="/knowledge-system/assets/js/4.058f70f4.js"><link rel="prefetch" href="/knowledge-system/assets/js/40.c4942197.js"><link rel="prefetch" href="/knowledge-system/assets/js/41.bad01060.js"><link rel="prefetch" href="/knowledge-system/assets/js/42.21d2f0bf.js"><link rel="prefetch" href="/knowledge-system/assets/js/43.fcc65805.js"><link rel="prefetch" href="/knowledge-system/assets/js/44.ffede619.js"><link rel="prefetch" href="/knowledge-system/assets/js/45.26b61498.js"><link rel="prefetch" href="/knowledge-system/assets/js/46.b474d3b8.js"><link rel="prefetch" href="/knowledge-system/assets/js/47.ff4fa17b.js"><link rel="prefetch" href="/knowledge-system/assets/js/48.92b30c52.js"><link rel="prefetch" href="/knowledge-system/assets/js/49.d5e95780.js"><link rel="prefetch" href="/knowledge-system/assets/js/5.7840448f.js"><link rel="prefetch" href="/knowledge-system/assets/js/50.db9933b1.js"><link rel="prefetch" href="/knowledge-system/assets/js/51.e8c83af0.js"><link rel="prefetch" href="/knowledge-system/assets/js/52.19667db8.js"><link rel="prefetch" href="/knowledge-system/assets/js/53.f2c3150e.js"><link rel="prefetch" href="/knowledge-system/assets/js/54.56cf6ce5.js"><link rel="prefetch" href="/knowledge-system/assets/js/55.74a46a4d.js"><link rel="prefetch" href="/knowledge-system/assets/js/56.07d66987.js"><link rel="prefetch" href="/knowledge-system/assets/js/57.6e73c719.js"><link rel="prefetch" href="/knowledge-system/assets/js/58.0abae5ac.js"><link rel="prefetch" href="/knowledge-system/assets/js/59.58f6eb45.js"><link rel="prefetch" href="/knowledge-system/assets/js/6.46d07af0.js"><link rel="prefetch" href="/knowledge-system/assets/js/60.43da1e15.js"><link rel="prefetch" href="/knowledge-system/assets/js/61.4ce82da9.js"><link rel="prefetch" href="/knowledge-system/assets/js/62.a479d1c1.js"><link rel="prefetch" href="/knowledge-system/assets/js/64.4594391c.js"><link rel="prefetch" href="/knowledge-system/assets/js/65.d27951d8.js"><link rel="prefetch" href="/knowledge-system/assets/js/66.948f50bb.js"><link rel="prefetch" href="/knowledge-system/assets/js/67.ce6538d6.js"><link rel="prefetch" href="/knowledge-system/assets/js/68.a4a194f4.js"><link rel="prefetch" href="/knowledge-system/assets/js/69.c6b1375d.js"><link rel="prefetch" href="/knowledge-system/assets/js/7.2777c9d4.js"><link rel="prefetch" href="/knowledge-system/assets/js/70.27f3eda7.js"><link rel="prefetch" href="/knowledge-system/assets/js/71.9c695185.js"><link rel="prefetch" href="/knowledge-system/assets/js/72.ee21a120.js"><link rel="prefetch" href="/knowledge-system/assets/js/73.10a48580.js"><link rel="prefetch" href="/knowledge-system/assets/js/74.20760841.js"><link rel="prefetch" href="/knowledge-system/assets/js/75.5c4ff11a.js"><link rel="prefetch" href="/knowledge-system/assets/js/76.175f4b4b.js"><link rel="prefetch" href="/knowledge-system/assets/js/77.f5faacec.js"><link rel="prefetch" href="/knowledge-system/assets/js/78.7bdf2bb0.js"><link rel="prefetch" href="/knowledge-system/assets/js/79.d48961ea.js"><link rel="prefetch" href="/knowledge-system/assets/js/8.f3d1da5a.js"><link rel="prefetch" href="/knowledge-system/assets/js/80.1dc29e35.js"><link rel="prefetch" href="/knowledge-system/assets/js/81.6e26603d.js"><link rel="prefetch" href="/knowledge-system/assets/js/82.d33c0e3e.js"><link rel="prefetch" href="/knowledge-system/assets/js/83.c1a041c3.js"><link rel="prefetch" href="/knowledge-system/assets/js/84.f09d0e23.js"><link rel="prefetch" href="/knowledge-system/assets/js/85.c823c3b3.js"><link rel="prefetch" href="/knowledge-system/assets/js/86.07e9f9c7.js"><link rel="prefetch" href="/knowledge-system/assets/js/87.24e8649c.js"><link rel="prefetch" href="/knowledge-system/assets/js/88.fef9674a.js"><link rel="prefetch" href="/knowledge-system/assets/js/9.2bd407cb.js">
    <link rel="stylesheet" href="/knowledge-system/assets/css/0.styles.4e160e22.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/knowledge-system/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/knowledge-system/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/knowledge-system/CSS/layout/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/knowledge-system/JS/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/knowledge-system/React/" class="nav-link router-link-active">
  React
</a></div><div class="nav-item"><a href="/knowledge-system/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/knowledge-system/broswer/work/" class="nav-link">
  æµè§ˆå™¨
</a></div><div class="nav-item"><a href="/knowledge-system/engineering/" class="nav-link">
  å·¥ç¨‹åŒ–
</a></div><div class="nav-item"><a href="/knowledge-system/scene/lottieUsage/" class="nav-link">
  å…¶ä»–
</a></div><div class="nav-item"><a href="/knowledge-system/web3d/" class="nav-link">
  web3d
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/knowledge-system/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/knowledge-system/CSS/layout/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/knowledge-system/JS/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/knowledge-system/React/" class="nav-link router-link-active">
  React
</a></div><div class="nav-item"><a href="/knowledge-system/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/knowledge-system/broswer/work/" class="nav-link">
  æµè§ˆå™¨
</a></div><div class="nav-item"><a href="/knowledge-system/engineering/" class="nav-link">
  å·¥ç¨‹åŒ–
</a></div><div class="nav-item"><a href="/knowledge-system/scene/lottieUsage/" class="nav-link">
  å…¶ä»–
</a></div><div class="nav-item"><a href="/knowledge-system/web3d/" class="nav-link">
  web3d
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ä¸ƒä¸ƒå…«å…«</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/React/7788/set-interval.html" class="sidebar-link">functional component ä¸­çš„ setInterval</a></li><li><a href="/knowledge-system/React/7788/react-etc.html" class="sidebar-link">reactç›¸å…³æŠ€æœ¯æ ˆ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/knowledge-system/React/state-management/" class="sidebar-heading clickable router-link-active open"><span>çŠ¶æ€ç®¡ç†</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/React/state-management/context-vs-redux.html" class="sidebar-link">reduxåŸºç¡€</a></li><li><a href="/knowledge-system/React/state-management/redux-combine-and-saga.html" class="sidebar-link">reduxçš„combineReducerå’Œä¸­é—´ä»¶</a></li><li><a href="/knowledge-system/React/state-management/zustand.html" aria-current="page" class="active sidebar-link">zustand</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#ç‰¹ç‚¹" class="sidebar-link">ç‰¹ç‚¹</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#ä½¿ç”¨" class="sidebar-link">ä½¿ç”¨</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#åŸç†" class="sidebar-link">åŸç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#å¦‚ä½•å·¥ä½œ" class="sidebar-link">å¦‚ä½•å·¥ä½œï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#ç®€æ˜“ç‰ˆæœ¬çš„-zustand" class="sidebar-link">ç®€æ˜“ç‰ˆæœ¬çš„ zustand</a></li></ul></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#å…³äºæ‰‹åŠ¨æ¸²æŸ“ä¼˜åŒ–" class="sidebar-link">å…³äºæ‰‹åŠ¨æ¸²æŸ“ä¼˜åŒ–</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#æ¯ä¸ªçŠ¶æ€å•ç‹¬-selector-æå–" class="sidebar-link">æ¯ä¸ªçŠ¶æ€å•ç‹¬ selector æå–</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#æ´¾ç”ŸçŠ¶æ€å•ç‹¬ç®¡ç†" class="sidebar-link">æ´¾ç”ŸçŠ¶æ€å•ç‹¬ç®¡ç†</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#å¤æ‚ç»„ä»¶åŸå­åŒ–-ç»†ç²’åº¦-memo" class="sidebar-link">å¤æ‚ç»„ä»¶åŸå­åŒ–(ç»†ç²’åº¦ memo)</a></li></ul></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#å…¶ä»–ç»†èŠ‚orå»¶ä¼¸" class="sidebar-link">å…¶ä»–ç»†èŠ‚orå»¶ä¼¸</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/React/state-management/zustand.html#æ¨èé˜…è¯»" class="sidebar-link">æ¨èé˜…è¯»</a></li></ul></li><li><a href="/knowledge-system/React/state-management/jotai.html" class="sidebar-link">jotai</a></li></ul></section></li><li><a href="/knowledge-system/React/animate/" class="sidebar-link">åŠ¨ç”»åº“</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>å­¦å®Œ redux å…¨å®¶æ¡¶ï¼Œè¶çƒ­æ·±å…¥å­¦ä¹ ä¸€ä¸‹ zustandï¼Œå› ä¸º zustand å’Œ redux çš„è®¾è®¡ç†å¿µç›¸ä¼¼ï¼Œå®˜ç½‘ä¹Ÿè¯´äº†â€œConceptually, Zustand and Redux are quite similar, both are based on an immutable state model.â€<br> <a href="https://codesandbox.io/s/react-zhuang-tai-guan-li-xue-xi-dglmj8?file=/src/by-zustand/main.tsx" target="_blank" rel="noopener noreferrer">å®Œæ•´ç¤ºä¾‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="header-anchor">#</a> ç‰¹ç‚¹</h2> <p>å¥½å¥½å¥½ï¼</p> <h4 id="ç”¨èµ·æ¥æ„Ÿè§‰"><a href="#ç”¨èµ·æ¥æ„Ÿè§‰" class="header-anchor">#</a> ç”¨èµ·æ¥æ„Ÿè§‰</h4> <ul><li>ğŸ¤— ç§¯ææ‹¥æŠ± hooks</li> <li>ğŸ«§ ä¸éœ€è¦ä½¿ç”¨ context providers åŒ…è£¹åº”ç”¨ã€ä¹Ÿæ²¡æœ‰ reducer é‚£ç§æ¨¡ç‰ˆä»£ç </li> <li>ğŸ«§  API è®¾è®¡åœ°ä¼˜é›…æ¸…æ™°ï¼ˆcreateã€usexxxStore å¤§éƒ¨åˆ†å¤Ÿç”¨äº†ï¼‰</li> <li>ğŸ³ï¸â€ğŸŒˆ æ”¯æŒå¤šä¸ª store</li> <li>ğŸ«§ ç›´æ¥æ”¯æŒå¼‚æ­¥ï¼Œä¸éœ€è¦å¦å¤–å¼•å…¥ä¸­é—´ä»¶</li> <li>ğŸ’ª å¤–éƒ¨å¯ç”¨ï¼Œè¯¦è§ç¤ºä¾‹ä¸­çš„â€œincrement å¦ä¸€ç§å†™æ³•â€</li> <li>ğŸ’ å¯ä»¥æŒä¹…åŒ–ï¼ˆå­˜åˆ° localStorageï¼‰</li> <li>ğŸ”Œ å¯æ‰©å±•ï¼ˆæ’å…¥ä¸­é—´ä»¶ï¼‰</li> <li>ğŸ˜Š å¿ƒæ™ºè´Ÿæ‹…ä½</li></ul> <h4 id="åŸç†æ¶æ„ä¸Š"><a href="#åŸç†æ¶æ„ä¸Š" class="header-anchor">#</a> åŸç†æ¶æ„ä¸Š</h4> <ul><li>å†…éƒ¨ä¸¤ä¸ªé‡è¦éƒ¨åˆ†ï¼ŒVanilla å±‚æ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼çš„å®ç°ï¼ˆè¯»å– stateï¼Œæä¾› subscribe æ–¹æ³•ç»™ React å±‚ï¼‰ã€React å±‚æ‰§è¡Œ subscribe æ³¨å†Œ listenerï¼Œé€šè¿‡ forceUpdate å¯¹ç»„ä»¶è¿›è¡Œé‡æ¸²æŸ“ã€‚</li> <li>é‡æ–°æ¸²æŸ“æ—¶å¯¹æ¯”å‡½æ•°é»˜è®¤æ˜¯ Object.isï¼Œæ‰€ä»¥æ¸²æŸ“ä¼˜åŒ–ä¸»è¦åœ¨äºä¸šåŠ¡å±‚çš„ selector å†™æ³•å’Œä¼ å…¥ equalityFn å¯¹æ¯”å‡½æ•°</li></ul> <h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="header-anchor">#</a> ä½¿ç”¨</h2> <ol><li>é€šè¿‡ create å®šä¹‰ store</li> <li>é€šè¿‡ const xxx = usexxxStore(selector,equalityFn)è·å– state
<blockquote><p>è¿™é‡Œçš„ state å¯ä»¥æ˜¯æ•°æ®ä¹Ÿå¯ä»¥æ˜¯æ”¹å˜æ•°æ®çš„æ–¹æ³•ï¼Œå…·ä½“çœ‹ç¤ºä¾‹å°±æ˜ç™½äº†</p></blockquote></li></ol> <h4 id="å®šä¹‰-store-create"><a href="#å®šä¹‰-store-create" class="header-anchor">#</a> å®šä¹‰ store -- create</h4> <ul><li>todoStore</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./my-zustand&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> queryMockList <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../mock-fns&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Todo</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  content<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">State</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  todoList<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Actions</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">create</span><span class="token operator">:</span> <span class="token punctuation">(</span>qty<span class="token operator">:</span> Todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">finish</span><span class="token operator">:</span> <span class="token punctuation">(</span>qty<span class="token operator">:</span> Todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useTodoStore <span class="token operator">=</span> <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>State <span class="token operator">&amp;</span> Actions<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>set<span class="token punctuation">,</span> get<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// å¾…åŠäº‹é¡¹</span>
  todoList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// åˆ›å»º</span>
  <span class="token function-variable function">create</span><span class="token operator">:</span> <span class="token punctuation">(</span>qty<span class="token operator">:</span> Todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> todoList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>todoList<span class="token punctuation">,</span> qty<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// åˆå§‹è·å–</span>
  <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">queryMockList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> todoList<span class="token operator">:</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>countStore</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./my-zustand&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useCountStore <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">set</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//increment å¦ä¸€ç§å†™æ³•</span>
<span class="token comment">/* export const increment = () =&gt; {
  useCountStore.setState((state) =&gt; ({ count: state.count + 1 }));
}; */</span>
</code></pre></div><h4 id="ä½¿ç”¨-store-usexxxstore"><a href="#ä½¿ç”¨-store-usexxxstore" class="header-anchor">#</a> ä½¿ç”¨ store -- usexxxStore</h4> <ul><li>Header ç”¨æ¥æ–°å¢ todo å’Œè‡ªå¢ count</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">Header</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">useCountStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coutState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> coutState<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> inCount <span class="token operator">=</span> <span class="token function">useCountStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coutState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> coutState<span class="token punctuation">.</span>increment<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> createTodo <span class="token operator">=</span> <span class="token function">useTodoStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todoState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todoState<span class="token punctuation">.</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">addTodo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> inputEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;todo-input&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">;</span>
    <span class="token keyword">const</span> content <span class="token operator">=</span> inputEle<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token function">createTodo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> count<span class="token punctuation">,</span> content <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">inCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>todo-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>addTodo<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>+<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          â•
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">è‡ªå¢idä¸º</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>List åˆ—è¡¨ç»„ä»¶</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">List</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> todoList <span class="token operator">=</span> <span class="token function">useTodoStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todoState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todoState<span class="token punctuation">.</span>todoList<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> initialTodoList <span class="token operator">=</span> <span class="token function">useTodoStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todoState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todoState<span class="token punctuation">.</span>initial<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">initialTodoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>todoList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>main.tsx</li></ul> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> rootElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>rootElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token comment">// &lt;StrictMode&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ä½¿ç”¨äº†zustand</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">æ·»åŠ ä¸€ä¸ªå¾…åŠ</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Header</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">

    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å¾…åŠåˆ—è¡¨</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">List</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">// &lt;/StrictMode&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="åŸç†"><a href="#åŸç†" class="header-anchor">#</a> åŸç†</h2> <h3 id="å¦‚ä½•å·¥ä½œ"><a href="#å¦‚ä½•å·¥ä½œ" class="header-anchor">#</a> å¦‚ä½•å·¥ä½œï¼Ÿ</h3> <ol><li>è°ƒç”¨ create</li></ol> <ul><li><ul><li>ä¼ å…¥ create çš„å‚æ•°ä¸­å®šä¹‰ çŠ¶æ€ã€æ–¹æ³•ã€‚å¦‚ â¬†ï¸ ç¤ºä¾‹ä¸­çš„ countã€inCount</li></ul></li></ul> <ol start="2"><li>zustand åˆ›å»ºäº†ä¸€ä¸ª storeï¼Œè¿™ä¸ª store çš„æœºåˆ¶å’Œ redux ä¸€æ ·ï¼Œæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å¼çš„</li> <li>zustand åˆ›å»ºäº†ä¸€ä¸ª usexxxStoreï¼ˆç»Ÿç§°ï¼‰ hook ï¼Œè¿™ä¸ªå°±æ˜¯ create çš„è¿”å›å€¼ã€‚usexxxStore å†…éƒ¨é€»è¾‘å·²ç»å®šä¹‰äº†ä½†ç›®å‰è¿˜æ²¡æœ‰æ‰§è¡Œã€‚</li> <li>ç»„ä»¶ä¸­è°ƒç”¨ usexxxStore æ¥è·å–çŠ¶æ€ã€æ–¹æ³•</li></ol> <ul><li><ul><li>ä¼ å…¥ selector(ç”¨æ¥ç”Ÿæˆ stateSlice) å’Œ equality å¯¹æ¯”å‡½æ•°</li></ul></li></ul> <ol start="5"><li>æ¯ä¸€å¤„ usexxxStore ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™å¯¹ store è¿›è¡Œäº†è®¢é˜…ï¼Œåƒ store ä¸­æ³¨å†Œäº† listener</li> <li>ç»„ä»¶ä¸­æ”¹å˜äº†çŠ¶æ€ï¼Œå¦‚æ‰§è¡Œ â¬†ï¸ ç¤ºä¾‹ä¸­çš„ inCount æ–¹æ³•</li> <li>store ä¸­çš„ listener ä¾æ¬¡æ‰§è¡Œ</li> <li>listener å†…éƒ¨ç”¨ equality æ¥å¯¹æ¯”æ–°æ—§ stateSliceï¼Œå¦‚æœç¡®å®æ”¹å˜äº†åˆ™æ›´æ–°ç»„ä»¶</li></ol> <h3 id="ç®€æ˜“ç‰ˆæœ¬çš„-zustand"><a href="#ç®€æ˜“ç‰ˆæœ¬çš„-zustand" class="header-anchor">#</a> ç®€æ˜“ç‰ˆæœ¬çš„ zustand</h3> <ul><li>Vanilla å±‚çš„ createStore ï¼ˆ<a href="https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts" target="_blank" rel="noopener noreferrer">æºç  vanilla.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼‰
å’Œç®€æ˜“ç‰ˆæœ¬çš„ redux å·®ä¸å¤šï¼Œä¸ redux ä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äº setStateï¼Œredux æ”¹å˜çŠ¶æ€ä¾èµ–äº reducer çš„è¿”å›å€¼</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token parameter">createState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> state<span class="token punctuation">;</span>
  <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">listener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> listeners<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
      listeners<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">fnOrObj<span class="token punctuation">,</span> replace</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> nextState <span class="token operator">=</span> <span class="token keyword">typeof</span> fnOrObj <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function">fnOrObj</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">:</span> fnOrObj<span class="token punctuation">;</span>
    <span class="token keyword">const</span> previousState <span class="token operator">=</span> state<span class="token punctuation">;</span>
    state <span class="token operator">=</span> replace <span class="token operator">?</span> nextState <span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">listener</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">listener</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> previousState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">destory</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    listeners <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token punctuation">{</span> getState<span class="token punctuation">,</span> setState<span class="token punctuation">,</span> subscribe<span class="token punctuation">,</span> destory <span class="token punctuation">}</span><span class="token punctuation">;</span>
  state <span class="token operator">=</span> <span class="token function">createState</span><span class="token punctuation">(</span>setState<span class="token punctuation">,</span> getState<span class="token punctuation">,</span> api<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> api<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>React å±‚çš„ create ï¼ˆ<a href="https://github.com/pmndrs/zustand/blob/main/src/react.ts" target="_blank" rel="noopener noreferrer">æºç  react.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼‰<br>
åˆä¸€æ¬¡å¾ˆå¤§çš„å˜æ›´ï¼Œå¯ä»¥åœ¨<a href="https://github.com/pmndrs/zustand/commit/a34649d35ab6dc91b658729a94764a5c1560fcda#diff-ca56e63fa839455c920562a44ebc44594f47957bbd3e9873c8a9e64104af2c41" target="_blank" rel="noopener noreferrer">è¿™æ¬¡æäº¤ä¸­<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ‰¾åˆ°
å˜æ›´ä¹‹åæ ¸å¿ƒçš„éƒ¨åˆ†ä¾èµ–äºç¬¬ä¸‰æ–¹ useSyncExternalStoreWithSelectorï¼Œä¸ºäº†æ–¹ä¾¿è§£é‡Šå·¥ä½œæµç¨‹ï¼Œä¸‹é¢å±•ç¤ºå˜æ›´ä¹‹å‰çš„æºç ã€‚ğŸ«¶ æ³¨é‡Šå¾ˆé‡è¦å“¦ï½</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">createState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>createState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token parameter">selector <span class="token operator">=</span> api<span class="token punctuation">.</span>getState<span class="token punctuation">,</span> equalityFn <span class="token operator">=</span> Object<span class="token punctuation">.</span>is</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> hookSpaceRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>selector<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> forceUpdate<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ¯ä¸€ä¸ªuseStoreç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œåˆå§‹åŒ–ä¸‰ä¸ªref ---- hookç©ºé—´çš„åˆå§‹åŒ–ç¬¬ä¸€éƒ¨åˆ†</span>
    <span class="token comment">// ä¸‰ä¸ªref æŠŠæœ¬hookç©ºé—´ stateã€selectorã€selectedState å­˜ä¸‹æ¥</span>
    <span class="token comment">// æ–¹ä¾¿storeä¸­stateå˜åŒ–ã€ä¸šåŠ¡å±‚renderçš„æ—¶å€™å–å€¼</span>
    <span class="token keyword">const</span> stateRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> selectorRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> stateSliceRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token function">selector</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//TODO</span>
    <span class="token comment">//æºç ä¸­è¿˜æœ‰ä¸€æ®µuselayoutEffect(()=&gt;{})çš„é€»è¾‘ï¼Œ</span>
    <span class="token comment">//å»æ‰ä¹Ÿä¸å½±å“å‘€ï¼Œä¸æ‡‚è¿™æ®µé€»è¾‘å¹²å˜›çš„</span>

    <span class="token function">useLayoutEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ¯ä¸€ä¸ªuseStoreç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œè®¢é˜…çŠ¶æ€å˜åŒ– ------ hookç©ºé—´çš„åˆå§‹åŒ–ç¬¬äºŒéƒ¨åˆ†</span>
      <span class="token keyword">const</span> <span class="token function-variable function">listener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä¸šåŠ¡å±‚æ¯æ¬¡setState</span>
        <span class="token comment">//å–å‡ºå½“å‰çš„çŠ¶æ€ï¼ˆä¸€ä¸ªstoreä¸­çš„å…¨é‡çŠ¶æ€ï¼‰</span>
        <span class="token keyword">const</span> nextState <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šè¿‡å¯¹åº”çš„selectorè®¡ç®—å‡ºå½“å‰çš„çŠ¶æ€åˆ‡ç‰‡</span>
        <span class="token comment">//å› ä¸ºæ¯ä¸ªuseStoreçš„æ—¶å€™éƒ½åˆå§‹åŒ–äº†ä¸€ä¸ªselectorRefï¼Œæ‰€ä»¥é€šè¿‡selectorRef.currentå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„selector</span>
        <span class="token comment">//ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨useStoreä¼ å…¥çš„selectorè®¡ç®—å‘¢ï¼Ÿå› ä¸ºlistenerçš„æ‰§è¡Œå’ŒuseStoreçš„è°ƒç”¨æ˜¯å‰²è£‚çš„ï¼Œç”¨useStoreä¼ å…¥çš„selectorå¹¶ä¸æ˜¯å¯¹åº”çš„selector</span>
        <span class="token keyword">const</span> nextStateSlice <span class="token operator">=</span> selectorRef<span class="token punctuation">.</span><span class="token function">current</span><span class="token punctuation">(</span>nextState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¯”è¾ƒçŠ¶æ€åˆ‡ç‰‡æ˜¯å¦å˜åŒ–äº†ï¼Œå˜åŒ–äº†æ‰æ›´æ–°</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">equalityFn</span><span class="token punctuation">(</span>nextStateSlice<span class="token punctuation">,</span> stateSliceRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// æ›´æ–°çŠ¶æ€</span>
          stateRef<span class="token punctuation">.</span>current <span class="token operator">=</span> nextState<span class="token punctuation">;</span>
          <span class="token comment">// æ›´æ–°çŠ¶æ€åˆ‡ç‰‡ï¼Œç”¨äºä¸‹ä¸€æ¬¡è¿›å…¥listeneræ—¶çš„æ¯”è¾ƒ</span>
          stateSliceRef<span class="token punctuation">.</span>current <span class="token operator">=</span> nextStateSlice<span class="token punctuation">;</span>
          <span class="token comment">// è§¦å‘ä¸šåŠ¡å±‚çš„render</span>
          <span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// æ— éœ€æ›´æ–°</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> unSubscribe <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å½“ç»„ä»¶é”€æ¯ï¼Œæˆ‘ä»¬éœ€è¦å–æ¶ˆè®¢é˜…</span>
      <span class="token keyword">return</span> unSubscribe<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> stateSliceRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> useStore<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å…³äºæ‰‹åŠ¨æ¸²æŸ“ä¼˜åŒ–"><a href="#å…³äºæ‰‹åŠ¨æ¸²æŸ“ä¼˜åŒ–" class="header-anchor">#</a> å…³äºæ‰‹åŠ¨æ¸²æŸ“ä¼˜åŒ–</h2> <p>useXxxStore(selector,equityFn)ä¸­ equityFn æ˜¯æ‰‹åŠ¨ä¼˜åŒ–çš„ä¸‡é‡‘æ²¹ï¼Œä»¥ä¸‹åœºæ™¯æ˜¯æŒ‡å¦‚æœä¸ç”¨ equityFnï¼Œä»ä»£ç ä¹ æƒ¯ä¸Š or ä»£ç è®¾è®¡ä¸Šè¯¥å¦‚ä½•ä¼˜åŒ–ã€‚<br>
ä¸‹é¢çš„ä¾‹å­ä¸ä¸€å®šè´´åˆ‡ï¼Œå› ä¸ºé€šå¸¸éœ€è¦æ‰‹åŠ¨æ¸²æŸ“ä¼˜åŒ–çš„éƒ½æ˜¯å¤§å‹é¡¹ç›®ï¼Œä½†æ˜¯ä» todoList è¿™æ ·çš„å° demo å…¥æ‰‹å»è§£é‡Šå¦‚ä½•åšåˆ°ä¼˜åŒ–åè€Œæ˜¯ä¸ªå¥½æ–¹æ³•ã€‚</p> <h3 id="æ¯ä¸ªçŠ¶æ€å•ç‹¬-selector-æå–"><a href="#æ¯ä¸ªçŠ¶æ€å•ç‹¬-selector-æå–" class="header-anchor">#</a> æ¯ä¸ªçŠ¶æ€å•ç‹¬ selector æå–</h3> <p>æ‹¿ Header ç»„ä»¶ä¸¾ä¾‹ï¼Œcountï¼ŒinCount çš„å–å€¼å¦‚æœæ˜¯è¿™æ ·çš„ï¼Œè€Œä¸æ˜¯ â¬†ï¸ ç¤ºä¾‹ä¸­çš„é‚£æ ·å•ç‹¬ selector</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> inCount <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useCountStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
  <span class="token literal-property property">inCount</span><span class="token operator">:</span> state<span class="token punctuation">.</span>increment<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å‡è®¾å½“å‰ count çš„å€¼æ˜¯ 5ï¼ŒæŸä¸ªåœ°æ–¹ set äº† count çš„å€¼ï¼Œä½†ä»ç„¶æ˜¯ 5ã€‚<br>
ç”¨ä»¥ä¸Šè¿™ç§åˆå¹¶å†™æ³•ä¼šè§¦å‘ renderã€‚<br>
ğŸš€ æ‰€ä»¥è¿˜æ˜¯å»ºè®®<strong>æ‹†å¼€ selector</strong>ã€‚</p> <h3 id="æ´¾ç”ŸçŠ¶æ€å•ç‹¬ç®¡ç†"><a href="#æ´¾ç”ŸçŠ¶æ€å•ç‹¬ç®¡ç†" class="header-anchor">#</a> æ´¾ç”ŸçŠ¶æ€å•ç‹¬ç®¡ç†</h3> <p>æ–°åŠŸèƒ½ï¼šè¦å¯¹ todoList çš„æ€»æ¡æ•°åšç»Ÿè®¡ï¼Œåœ¨é¡¹ç›®ä¸­çš„å¤šå¤„å±•ç¤ºã€‚<br>
å¦‚æœè¿™æ ·å†™</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">TotalShow</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> todoList <span class="token operator">=</span> <span class="token function">useTodoStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todoState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todoState<span class="token punctuation">.</span>todoList<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ï¼ˆå…±</span><span class="token punctuation">{</span>todoList<span class="token punctuation">.</span>length<span class="token punctuation">}</span><span class="token plain-text">æ¡ï¼‰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>å‡è®¾å¯¹ todoList çš„æŸä¸€æ¡å†…å®¹è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½†æ²¡æœ‰å‘ç”Ÿå¢åˆ ã€‚<br>
ç”¨ä»¥ä¸Šè¿™ç§å†™æ³•ä¼šè§¦å‘ renderï¼Œå°±è§¦å‘è¿™ç§ä¸å¿…è¦çš„ renderã€‚<br>
ğŸš€ ç±»ä¼¼è¿™æ ·çš„æ´¾ç”ŸçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥<strong>å•ç‹¬</strong>ç”¨ä¸€ä¸ª todoLength<strong>çŠ¶æ€å»ç»´æŠ¤</strong>ï¼Œåƒä¸‹é¢è¿™æ ·</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">/* todoStore.ts */</span>
<span class="token comment">// ... è¾ƒä¸ºç®€å•ï¼Œçœç•¥ä»£ç </span>
<span class="token comment">// å¢åŠ ä¸€ä¸ªtodoLengthçš„çŠ¶æ€</span>
<span class="token comment">// ... è¾ƒä¸ºç®€å•ï¼Œçœç•¥ä»£ç </span>
<span class="token comment">/* TotalShow.tsx */</span>
<span class="token keyword">const</span> <span class="token function-variable function">TotalShow</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> todoList <span class="token operator">=</span> <span class="token function">useTodoStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todoState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todoState<span class="token punctuation">.</span>todoLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ï¼ˆå…±</span><span class="token punctuation">{</span>todoLength<span class="token punctuation">}</span><span class="token plain-text">æ¡ï¼‰</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å¤æ‚ç»„ä»¶åŸå­åŒ–-ç»†ç²’åº¦-memo"><a href="#å¤æ‚ç»„ä»¶åŸå­åŒ–-ç»†ç²’åº¦-memo" class="header-anchor">#</a> å¤æ‚ç»„ä»¶åŸå­åŒ–(ç»†ç²’åº¦ memo)</h3> <p>æ–°åŠŸèƒ½ï¼šå–å‡ºåˆ—è¡¨çš„å‰ 3 é¡¹å†…å®¹å•ç‹¬æ˜¾ç¤ºã€‚<br>
æŒ‰ç…§ä¸Šé¢&lt;List/&gt;ç»„ä»¶çš„å†™æ³•ï¼ŒtodoList æ˜¯æ•´ä½“æ›´æ–°çš„ï¼Œåˆ—è¡¨ä¸­æŸä¸€é¡¹çš„å†…å®¹æ”¹å˜ï¼Œæ•´ä¸ªåˆ—è¡¨éƒ½ä¼šæ›´æ–°ã€‚<br>
å¦‚æœæˆ‘ä»¬æƒ³è¦åªæ›´æ–°ï¼Œä¿®æ”¹çš„é‚£ä¸€é¡¹è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿä¸Šé¢çš„ä¸¤ç§æ–¹æ³•è‚¯å®šéƒ½ä¸é€‚ç”¨äº† ï½<br>
ğŸš€æŠŠ list çš„æ¯ä¸€é¡¹å•ç‹¬åšä¸ºä¸€ä¸ª<strong>ç»„ä»¶ï¼Œæ‹†åˆ†</strong>å‡ºæ¥ï¼Œåƒè¿™æ ·</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">ListItemContent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token string">&quot;=======ListItemContent render ====== , useTodoStore*1, index=&quot;</span><span class="token punctuation">,</span>
    index
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span>
    <span class="token function">useTodoStore</span><span class="token punctuation">(</span>
      <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todoState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todoState<span class="token punctuation">.</span>todoList<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">TopN</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>n<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">&lt;h2&gt;å‰</span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token plain-text">é¡¹</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span>length<span class="token operator">:</span>n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ListItemContent</span></span> <span class="token attr-name">index</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ListItemContent</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
}
</span></code></pre></div><h2 id="å…¶ä»–ç»†èŠ‚orå»¶ä¼¸"><a href="#å…¶ä»–ç»†èŠ‚orå»¶ä¼¸" class="header-anchor">#</a> å…¶ä»–ç»†èŠ‚orå»¶ä¼¸</h2> <ul><li>zustand set æ•°æ®çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯åˆå¹¶çš„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ true åˆ™ä»£è¡¨è¦†ç›–</li> <li>zustand çš„æŒä¹…åŒ–ä¸»è¦æ˜¯ç”¨åˆ° persist</li> <li>zustand ç»“åˆ immerï¼Œå¯ä»¥ä» immutableâ€œè½¬æ¢ä¸ºâ€mutable</li> <li>zustand ç»“åˆ redux likeã€devtoolsã€combime store ç­‰ä¸­é—´ä»¶æ›´å¼ºå¤§</li></ul> <h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="header-anchor">#</a> æ¨èé˜…è¯»</h2> <ul><li><p><a href="https://zhuanlan.zhihu.com/p/591981209" target="_blank" rel="noopener noreferrer">è°ˆè°ˆå¤æ‚åº”ç”¨çš„çŠ¶æ€ç®¡ç†ï¼ˆä¸Šï¼‰ï¼šä¸ºä»€ä¹ˆæ˜¯ Zustand<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://zhuanlan.zhihu.com/p/592383756" target="_blank" rel="noopener noreferrer">...ä¸‹...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§ä¸ºéœ‡æ’¼ ğŸ˜² ï¼ç›´å‘¼ zustand yyds ğŸ¥³</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/knowledge-system/React/state-management/redux-combine-and-saga.html" class="prev">
        reduxçš„combineReducerå’Œä¸­é—´ä»¶
      </a></span> <span class="next"><a href="/knowledge-system/React/state-management/jotai.html">
        jotai
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/knowledge-system/assets/js/app.4492b903.js" defer></script><script src="/knowledge-system/assets/js/2.3522bde2.js" defer></script><script src="/knowledge-system/assets/js/63.d0add6b4.js" defer></script>
  </body>
</html>
