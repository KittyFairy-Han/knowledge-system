<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="image/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/knowledge-system/assets/css/0.styles.c0d58452.css" as="style"><link rel="preload" href="/knowledge-system/assets/js/app.91991297.js" as="script"><link rel="preload" href="/knowledge-system/assets/js/2.72f9c146.js" as="script"><link rel="preload" href="/knowledge-system/assets/js/4.21cfe184.js" as="script"><link rel="prefetch" href="/knowledge-system/assets/js/10.1c3f464c.js"><link rel="prefetch" href="/knowledge-system/assets/js/11.cd4654b3.js"><link rel="prefetch" href="/knowledge-system/assets/js/12.82ff83d7.js"><link rel="prefetch" href="/knowledge-system/assets/js/13.c571f69d.js"><link rel="prefetch" href="/knowledge-system/assets/js/14.1642fb33.js"><link rel="prefetch" href="/knowledge-system/assets/js/15.8ce627f9.js"><link rel="prefetch" href="/knowledge-system/assets/js/16.a9274315.js"><link rel="prefetch" href="/knowledge-system/assets/js/17.c4d63467.js"><link rel="prefetch" href="/knowledge-system/assets/js/18.27a0b707.js"><link rel="prefetch" href="/knowledge-system/assets/js/19.68bcb2a0.js"><link rel="prefetch" href="/knowledge-system/assets/js/20.4d007877.js"><link rel="prefetch" href="/knowledge-system/assets/js/21.f488fb0c.js"><link rel="prefetch" href="/knowledge-system/assets/js/22.8765783c.js"><link rel="prefetch" href="/knowledge-system/assets/js/23.4c57e416.js"><link rel="prefetch" href="/knowledge-system/assets/js/24.cb675276.js"><link rel="prefetch" href="/knowledge-system/assets/js/25.6ba968f3.js"><link rel="prefetch" href="/knowledge-system/assets/js/26.93616730.js"><link rel="prefetch" href="/knowledge-system/assets/js/27.73a2b06e.js"><link rel="prefetch" href="/knowledge-system/assets/js/28.76b678f5.js"><link rel="prefetch" href="/knowledge-system/assets/js/29.8a8b78e2.js"><link rel="prefetch" href="/knowledge-system/assets/js/3.3cde20bd.js"><link rel="prefetch" href="/knowledge-system/assets/js/30.51cd8dd9.js"><link rel="prefetch" href="/knowledge-system/assets/js/31.135a5117.js"><link rel="prefetch" href="/knowledge-system/assets/js/32.808957a4.js"><link rel="prefetch" href="/knowledge-system/assets/js/33.3ba5f8c3.js"><link rel="prefetch" href="/knowledge-system/assets/js/34.b7af2de3.js"><link rel="prefetch" href="/knowledge-system/assets/js/35.e8fb414b.js"><link rel="prefetch" href="/knowledge-system/assets/js/36.044ada3d.js"><link rel="prefetch" href="/knowledge-system/assets/js/37.b345f8ac.js"><link rel="prefetch" href="/knowledge-system/assets/js/38.d45ff75a.js"><link rel="prefetch" href="/knowledge-system/assets/js/39.c13a6165.js"><link rel="prefetch" href="/knowledge-system/assets/js/40.ea4bf75e.js"><link rel="prefetch" href="/knowledge-system/assets/js/41.fd82d80d.js"><link rel="prefetch" href="/knowledge-system/assets/js/42.fd9fefa9.js"><link rel="prefetch" href="/knowledge-system/assets/js/43.f6fa7cee.js"><link rel="prefetch" href="/knowledge-system/assets/js/44.b9aaba9a.js"><link rel="prefetch" href="/knowledge-system/assets/js/45.83acc421.js"><link rel="prefetch" href="/knowledge-system/assets/js/46.9a741cc0.js"><link rel="prefetch" href="/knowledge-system/assets/js/47.3c0a3995.js"><link rel="prefetch" href="/knowledge-system/assets/js/48.183c9920.js"><link rel="prefetch" href="/knowledge-system/assets/js/49.fcbc368f.js"><link rel="prefetch" href="/knowledge-system/assets/js/5.061d28d0.js"><link rel="prefetch" href="/knowledge-system/assets/js/50.8bbda3a1.js"><link rel="prefetch" href="/knowledge-system/assets/js/51.e51946c1.js"><link rel="prefetch" href="/knowledge-system/assets/js/52.e87177c7.js"><link rel="prefetch" href="/knowledge-system/assets/js/53.c53504e3.js"><link rel="prefetch" href="/knowledge-system/assets/js/54.f2562415.js"><link rel="prefetch" href="/knowledge-system/assets/js/55.09635f0c.js"><link rel="prefetch" href="/knowledge-system/assets/js/56.6afde217.js"><link rel="prefetch" href="/knowledge-system/assets/js/57.adae5c9c.js"><link rel="prefetch" href="/knowledge-system/assets/js/58.a5466384.js"><link rel="prefetch" href="/knowledge-system/assets/js/59.fb61cb04.js"><link rel="prefetch" href="/knowledge-system/assets/js/6.ff9323f5.js"><link rel="prefetch" href="/knowledge-system/assets/js/60.24853b26.js"><link rel="prefetch" href="/knowledge-system/assets/js/61.d2f73e24.js"><link rel="prefetch" href="/knowledge-system/assets/js/62.1ab1c7ec.js"><link rel="prefetch" href="/knowledge-system/assets/js/63.8e199ac9.js"><link rel="prefetch" href="/knowledge-system/assets/js/64.def173e6.js"><link rel="prefetch" href="/knowledge-system/assets/js/65.763a3c6f.js"><link rel="prefetch" href="/knowledge-system/assets/js/66.5585a964.js"><link rel="prefetch" href="/knowledge-system/assets/js/67.73ccef3c.js"><link rel="prefetch" href="/knowledge-system/assets/js/7.55b56534.js"><link rel="prefetch" href="/knowledge-system/assets/js/8.60f83b4e.js"><link rel="prefetch" href="/knowledge-system/assets/js/9.d2b936ca.js">
    <link rel="stylesheet" href="/knowledge-system/assets/css/0.styles.c0d58452.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/knowledge-system/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/knowledge-system/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/knowledge-system/CSS/layout/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/knowledge-system/JS/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/knowledge-system/broswer/work/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/knowledge-system/engineering/" class="nav-link router-link-active">
  工程化
</a></div><div class="nav-item"><a href="/knowledge-system/scene/lottieUsage/" class="nav-link">
  其他
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/knowledge-system/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/knowledge-system/CSS/layout/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/knowledge-system/JS/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/knowledge-system/broswer/work/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/knowledge-system/engineering/" class="nav-link router-link-active">
  工程化
</a></div><div class="nav-item"><a href="/knowledge-system/scene/lottieUsage/" class="nav-link">
  其他
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>模块化、组件化和设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/engineering/design/modularity.html" class="sidebar-link">模块化</a></li><li><a href="/knowledge-system/engineering/design/componential.html" class="sidebar-link">组件化</a></li><li><a href="/knowledge-system/engineering/design/design-pattern.html" class="sidebar-link">设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/knowledge-system/engineering/Vue/" class="sidebar-heading clickable"><span>Vue</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/engineering/Vue/use.html" class="sidebar-link">使用</a></li><li><a href="/knowledge-system/engineering/Vue/principle.html" class="sidebar-link">原理</a></li><li><a href="/knowledge-system/engineering/Vue/Vue3.html" class="sidebar-link">Vue3</a></li></ul></section></li><li><a href="/knowledge-system/engineering/React/" class="sidebar-link">React</a></li><li><a href="/knowledge-system/engineering/vdom/" class="sidebar-link">vdom</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/knowledge-system/engineering/webpack/" class="sidebar-heading clickable router-link-active open"><span>webpack</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge-system/engineering/webpack/main-flow.html" class="sidebar-link">主流程（主线剧情）</a></li><li><a href="/knowledge-system/engineering/webpack/chunk.html" class="sidebar-link">chunk</a></li><li><a href="/knowledge-system/engineering/webpack/optimization.html" class="sidebar-link">优化</a></li><li><a href="/knowledge-system/engineering/webpack/pluggable.html" aria-current="page" class="active sidebar-link">one-project-to-multiple-app</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#概念的理解与区分" class="sidebar-link">概念的理解与区分</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#具体方案" class="sidebar-link">具体方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#目录定制" class="sidebar-link">目录定制</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#打包配置" class="sidebar-link">打包配置</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#实现效果" class="sidebar-link">实现效果</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#针对开发环境的改造" class="sidebar-link">针对开发环境的改造</a></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#更自动化" class="sidebar-link">更自动化</a></li></ul></li><li class="sidebar-sub-header"><a href="/knowledge-system/engineering/webpack/pluggable.html#资料" class="sidebar-link">资料</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一个工程多个app包"><a href="#一个工程多个app包" class="header-anchor">#</a> 一个工程多个app包</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>工作项目中遇到过一个这样的需求：一个前端工程输出多个应用包，多个应用包是完全独立的。所以研究了一下一份前端工程代码(project)如何输出多个应用包(app)。</p> <h2 id="概念的理解与区分"><a href="#概念的理解与区分" class="header-anchor">#</a> 概念的理解与区分</h2> <ul><li>SPA 单页面</li></ul> <p>一个入口，一个包，可以共享store数据，通信方便。非SPA数据不共享。</p> <ul><li>MPA  多页面</li></ul> <p>多个入口输出还是一个包，有多个 html，资源文件夹共享，store数据不能共享。本质上只有一个 app。</p> <ul><li>多个app</li></ul> <p>本质上已经是完全不相关的app了，不涉及任何的资源文件夹共享，多个页面之间不能通信。</p> <h2 id="具体方案"><a href="#具体方案" class="header-anchor">#</a> 具体方案</h2> <p>我们以要输出 demo、other 两个插件为例，继续往下说~<br>
具体：demo 和 other，demo 包含两个页面 home 和 about，other 包含一个页面 home。</p> <h3 id="目录定制"><a href="#目录定制" class="header-anchor">#</a> 目录定制</h3> <h4 id="插件结构"><a href="#插件结构" class="header-anchor">#</a> 插件结构</h4> <div class="language-code extra-class"><pre class="language-text"><code>iarrm
  ├── demo
  |   ├──home
  |   └──about
  └── other
      └──home
</code></pre></div><h4 id="打包后输出目录"><a href="#打包后输出目录" class="header-anchor">#</a> 打包后输出目录</h4> <p>我们期望生成的目录是这样滴，并且希望可以单独输出一个插件或多个插件一起输出</p> <div class="language- extra-class"><pre class="language-text"><code>
 plugins
      └── demo
      |   ├── demo-home.html
      |   ├── demo-about.html
      |   └── assets
      |       ├── js
      |       ├── css
      |       └── img
      └── other
          ├── other-home.html
          └── assets
              ├── js
              ├── css
              └── img

</code></pre></div><h4 id="源码中的目录"><a href="#源码中的目录" class="header-anchor">#</a> 源码中的目录</h4> <p>那么，在源码中，目录的基本骨架可以这样设置</p> <div class="language- extra-class"><pre class="language-text"><code>project
├── ...
└──src
  └── apps
      ├── demo                 // ~ app
      |   ├── home             // ~ page
      |   |   ├──main.js
      |   |   └──App.vue
      |   └── about            // ~ page
      |       ├──main.js
      |       └──App.vue
      └── other                // ~app
          └── home            // ~ page
              ├──main.js
              └──App.vue


</code></pre></div><p>文件内容
<img src="/knowledge-system/assets/img/app-demo-src.245e3168.png" alt="app-demo-src"> <img src="/knowledge-system/assets/img/app-demo-src2.90df08ad.png" alt="app-demo-src2"></p> <h3 id="打包配置"><a href="#打包配置" class="header-anchor">#</a> 打包配置</h3> <p>通过命令行去控制具体输出某一个或多个 app<br>
配置命令行，关键点是 set PLUGIN_KEY=xxx</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">//package.json</span>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build:demo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;set PLUGIN_KEY=demo&amp;&amp;vue-cli-service build&quot;</span><span class="token punctuation">,</span> <span class="token comment">//想要输出demo插件则执行这个命令</span>
    <span class="token property">&quot;build:other&quot;</span><span class="token operator">:</span> <span class="token string">&quot;set PLUGIN_KEY=other&amp;&amp;vue-cli-service build&quot;</span><span class="token punctuation">,</span><span class="token comment">//想要输出other插件则执行这个命令</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:demo&amp;&amp;npm run build:other&quot;</span><span class="token punctuation">,</span><span class="token comment">//想要依次输出多个插件则用&amp;&amp;相连命令行</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>为每个插件配置输出位置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  outputDir<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">dist/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PLUGIN_KEY</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>配置 MPA，即为每个插件配置多页面。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> apps <span class="token operator">=</span> <span class="token punctuation">{</span>
  demo<span class="token operator">:</span> <span class="token punctuation">{</span>
    home<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/demo/home/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// page 的入口(相对于项目的根目录)</span>
      template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// 模板来源(相对于项目的根目录)</span>
      filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">demo-home.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// 输出位置(相对于 outputDir</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    about<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/demo/about/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">demo-about.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  other<span class="token operator">:</span> <span class="token punctuation">{</span>
    home<span class="token operator">:</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/other/home/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">other-home.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  pages<span class="token operator">:</span> apps<span class="token punctuation">[</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PLUGIN_KEY</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">//当 PLUGIN_KEY 为 demo 的时候，打包 demo 下的页面。</span>
  <span class="token comment">//    ......       other     .....  other</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>以输出 demo 插件为例，流程可以概括为<br> <img src="/knowledge-system/assets/img/app-demo-flow.35698f14.png" alt="app-demo-flow"></p> <h3 id="实现效果"><a href="#实现效果" class="header-anchor">#</a> 实现效果</h3> <p>运行 npm run build:demo 试一下吧<br> <img src="/knowledge-system/assets/img/app-demo-flow_demo.b5a94126.gif" alt="打包demo录屏"></p> <p>那如果 npm run build 是怎样的呢，看图就知道啦<br> <img src="/knowledge-system/assets/img/app-demo-flow_all.3aaf0ff7.gif" alt="打包录屏"></p> <p>依次启动两次打包流程，相当于<br>
① 手动 npm run build:demo 输出文件后。<br>
② 然后再手动 npm run build:other 输出文件。</p> <p>打包后的目录<br> <img src="data:image/png;base64,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" alt="app-demo-flow"></p> <p>直接打开 html 文件，看看能否正常加载到资源正常运行<br> <img src="/knowledge-system/assets/img/app-demo-flow_prod.ea3b347f.gif" alt="运行录屏"></p> <p>大功告成！<br>
以上已经能达到插件化的基本需求，对于生产环境来说没什么问题。但是对于开发环境下可能会不太方便，我们可能需要同时开发多个插件的多个页面。应该怎么做呢？</p> <h3 id="针对开发环境的改造"><a href="#针对开发环境的改造" class="header-anchor">#</a> 针对开发环境的改造</h3> <p>开发环境下我们就不分插件，让 apps 下面的所有 page 都参与打包。所以我们需要修改一下 pages 配置项，其他配置项不变。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token punctuation">{</span>
  demoHome<span class="token operator">:</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/demo/home/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// page 的入口(相对于项目的根目录)</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// 模板来源(相对于项目的根目录)</span>
    filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">demo-home.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// 输出位置(相对于 outputDir</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  demoAbout<span class="token operator">:</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/demo/about/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">demo-about.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  otherHome<span class="token operator">:</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/other/home/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">other-home.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  pages<span class="token operator">:</span> pages<span class="token punctuation">,</span>
  <span class="token comment">// apps下所有page</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>然后我们 npm run serve 启动项目<br>
可以正常运行
<img src="/knowledge-system/assets/img/app-demo-flow_dev.0f3faf74.gif" alt="dev环境">
这样就可以同时开发多个插件了</p> <h3 id="更自动化"><a href="#更自动化" class="header-anchor">#</a> 更自动化</h3> <p>上面的方案，每次新增插件或者页面的时候都需要重新配置。如果想要更自动化一点，可以利用 node 去读取固定目录下的文件，自动生成 pages。
在 vue.config.js 同级位置增加一个 config 目录</p> <div class="language-code extra-class"><pre class="language-text"><code>project
  ├── ...
  ├── config
  |    ├── dev.js
  |    ├── prod.js
  |    └── util.js
  └── vue.config.js

</code></pre></div><p>util.js 中定义一些公用的 node 方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getAppKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> pluginsPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src/apps&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> appKeys <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>pluginsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> appKeys<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getPageNames</span><span class="token punctuation">(</span><span class="token parameter">appKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> pagesPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../src/apps/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> pageNames <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>pagesPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> pageNames<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">setPage</span><span class="token punctuation">(</span><span class="token parameter">appKey<span class="token punctuation">,</span> pageName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// page 的入口(相对于项目的跟目录)</span>
    entry<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/apps/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/main.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">// 模板来源(相对于项目的跟目录)</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/common/template/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">// 输出位置(相对于 outputDir</span>
    filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">// 当使用 title 选项时，</span>
    <span class="token comment">// template 中的 title 标签需要是 &lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt;</span>
    title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">标签</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">页面</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  getAppKeys<span class="token punctuation">,</span>
  getPageNames<span class="token punctuation">,</span>
  setPage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>dev.js 中是针对开发环境的配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> getAppKeys<span class="token punctuation">,</span> getPageNames<span class="token punctuation">,</span> setPage <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">getAllPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> pluginKeys <span class="token operator">=</span> <span class="token function">getAppKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> pluginKey <span class="token keyword">of</span> pluginKeys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pageNames <span class="token operator">=</span> <span class="token function">getPageNames</span><span class="token punctuation">(</span>pluginKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> pageName <span class="token keyword">of</span> pageNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pages<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pluginKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">setPage</span><span class="token punctuation">(</span>pluginKey<span class="token punctuation">,</span> pageName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pages<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  publicPath<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
  pages<span class="token operator">:</span> <span class="token function">getAllPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>prod.js 中是针对生产环境的配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
 * @Author: 鱼小柔
 * @Date: 2020-12-26 15:30:15
 * @LastEditors: your name
 * @LastEditTime: 2021-09-25 15:21:24
 * @Description: 开发环境配置，会被vue.config.js引入和使用
 */</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> getPageNames<span class="token punctuation">,</span> setPage <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">getPagesFrom</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">appKey</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> pageNames <span class="token operator">=</span> <span class="token function">getPageNames</span><span class="token punctuation">(</span>appKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> pageName <span class="token keyword">of</span> pageNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pages<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">setPage</span><span class="token punctuation">(</span>appKey<span class="token punctuation">,</span> pageName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pages<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  publicPath<span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// ....</span>
  outputDir<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">dist/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PLUGIN_KEY</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  pages<span class="token operator">:</span> <span class="token function">getPagesFrom</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PLUGIN_KEY</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>vue.config.js 中根据环境变量进行区分，引入相应的配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> config <span class="token operator">=</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span>
    <span class="token operator">?</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config/prod.js&quot;</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config/dev.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// html中资源引入时的根路径</span>
  publicPath<span class="token operator">:</span> config<span class="token punctuation">.</span>publicPath<span class="token punctuation">,</span>
  <span class="token comment">// 输出包的根目录(相对于项目根目录</span>
  outputDir<span class="token operator">:</span> config<span class="token punctuation">.</span>outputDir<span class="token punctuation">,</span>
  <span class="token comment">// 静态资源目录（相对于outputDir</span>
  assetsDir<span class="token operator">:</span> <span class="token string">&quot;assets&quot;</span><span class="token punctuation">,</span>

  pages<span class="token operator">:</span>config<span class="token punctuation">.</span>pages<span class="token punctuation">,</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="资料"><a href="#资料" class="header-anchor">#</a> 资料</h2> <p><a href="https://github.com/KittyFairy-Han/study-demos" target="_blank" rel="noopener noreferrer">完整的代码在这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/knowledge-system/engineering/webpack/optimization.html" class="prev">
        优化
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/knowledge-system/assets/js/app.91991297.js" defer></script><script src="/knowledge-system/assets/js/2.72f9c146.js" defer></script><script src="/knowledge-system/assets/js/4.21cfe184.js" defer></script>
  </body>
</html>
